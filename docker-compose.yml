services:
  openvscode:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        TOOL: ${TOOL}
    container_name: openvscode-server
    ports:
      - "3000:3000"
    environment:
      - DISABLE_TERMINAL=true
      - TOOL_NAME=${TOOL}
    volumes:
      - .:/home/workspace:cached
      - ./custom-workspace-settings.json:/home/workspace/.vscode/custom-workspace-settings.json
      - ./custom-user-settings.json:/home/workspace/.vscode/custom-user-settings.json
    command: ["openvscode-server",
     "--without-connection-token",
     "--default-workspace", "/home/workspace/files",
     "--default-folder", "/home/workspace/files",
     "--install-extension", "/tmp/exts/layout-builder-0.0.1.vsix",
     "--install-extension", "/tmp/exts/auto-config-0.0.1.vsix",
     "--install-extension", "/tmp/exts/weaver-0.0.1.vsix",
     "--disable-workspace-trust",
     "--start-server"
    ]
